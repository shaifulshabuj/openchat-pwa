[build]
builder = "dockerfile"
dockerfilePath = "docker/api.Dockerfile"

[deploy]
startCommand = "npm run start"
healthcheckPath = "/"
healthcheckTimeout = 30
restartPolicyType = "on_failure"

[[services]]
name = "openchat-api"
source = "apps/api"

[services.variables]
NODE_ENV = "production"
DATABASE_URL = { value = "${{ DATABASE_URL }}" }
JWT_SECRET = { value = "${{ JWT_SECRET }}" }
REDIS_URL = { value = "${{ REDIS_URL }}" }

[services.domains]
# Will be automatically generated by Railway